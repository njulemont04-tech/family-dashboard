{% set total_items = list.items|length %} {% set done_items =
list.items|selectattr('done')|list|length %} {% set progress = (done_items /
total_items * 100) if total_items > 0 else 0 %}

<div class="col-md-6" id="list-card-{{ list.id }}">
  <a
    href="{{ url_for('view_list', list_id=list.id) }}"
    class="list-summary-card"
  >
    <div class="card-body">
      <h5 class="card-title">{{ list.name }}</h5>

      <!-- START: THE FIX -->
      <!-- This text will now always be visible -->
      <p class="card-text text-muted small mb-2">
        {{ done_items }} of {{ total_items }} items complete
      </p>

      <!-- Conditionally show either the progress bar OR the completed message -->
      {% if total_items > 0 and done_items == total_items %}
      <!-- State 1: All items are complete -->
      <div class="d-flex align-items-center text-success">
        <i class="bi bi-check-circle-fill me-2"></i>
        <span class="fw-bold">Completed</span>
      </div>
      {% else %}
      <!-- State 2: In-progress or empty list -->
      <div class="progress" style="height: 8px">
        <div
          class="progress-bar"
          role="progressbar"
          style="width: {{ progress }}%;"
          aria-valuenow="{{ progress }}"
          aria-valuemin="0"
          aria-valuamax="100"
        ></div>
      </div>
      {% endif %}
      <!-- END: THE FIX -->
    </div>
  </a>
</div>
