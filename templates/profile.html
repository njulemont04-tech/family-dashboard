{% extends 'base.html' %} {% block title %}My Profile{% endblock %} {% block
content %}
<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <h1 class="mb-4">My Profile</h1>

      <!-- Flash Messages -->
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %} {% for category, message in messages %}
      <div
        class="alert alert-{{ category }} alert-dismissible fade show"
        role="alert"
      >
        {{ message }}
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
          aria-label="Close"
        ></button>
      </div>
      {% endfor %} {% endif %} {% endwith %}

      <!-- Main Profile Card -->
      <div class="card mb-4">
        <div class="card-body">
          <div class="row align-items-center">
            <div class="col-md-4 text-center">
              <img
                src="{{ current_user.avatar_url }}"
                alt="{{ current_user.username }}'s avatar"
                class="img-fluid rounded-circle mb-3"
                style="width: 150px; height: 150px; object-fit: cover"
              />

              <h4 class="mb-3">{{ current_user.username }}</h4>
            </div>
            <div class="col-md-8">
              <form
                action="{{ url_for('upload_avatar') }}"
                method="POST"
                enctype="multipart/form-data"
              >
                <div class="mb-3">
                  <label for="avatar" class="form-label">Update Avatar</label>
                  <input
                    class="form-control"
                    id="avatar"
                    name="avatar"
                    type="file"
                    accept="image/png, image/jpeg, image/gif"
                  />
                </div>
                <button type="submit" class="btn btn-primary w-100">
                  Upload New Avatar
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- NEW: Change Password Card -->
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">Change Password</h5>
        </div>
        <div class="card-body">
          <form action="{{ url_for('change_password') }}" method="POST">
            <div class="mb-3">
              <label for="current_password" class="form-label"
                >Current Password</label
              >
              <input
                type="password"
                class="form-control"
                id="current_password"
                name="current_password"
                required
              />
            </div>
            <div class="mb-3">
              <label for="new_password" class="form-label">New Password</label>
              <input
                type="password"
                class="form-control"
                id="new_password"
                name="new_password"
                required
              />
            </div>
            <div class="mb-3">
              <label for="confirm_password" class="form-label"
                >Confirm New Password</label
              >
              <input
                type="password"
                class="form-control"
                id="confirm_password"
                name="confirm_password"
                required
              />
            </div>
            <button type="submit" class="btn btn-warning">
              Update Password
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
